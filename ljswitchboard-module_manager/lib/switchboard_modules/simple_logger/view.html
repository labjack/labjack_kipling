{{#with custom}}
<!-- <p></p> -->
<div id="logger_module" class="{{logger_mode}}">
<!-- <div id="logger_module" class="dashboard_mode"> -->
  <div id="logger_controls">
    <div id="navbar-example" class="navbar">
      <div class="navbar-inner">
        <div class="container1">
          <!-- <h2 class="brand active-log-controls">LJ</h2> -->
          <ul class="nav navbar-nav active-log-controls">
            <li>
              <!-- onClick="userLoggerStart()" -->
              <button class="win-command green" id="startBtn" rel="tootlip" title="Command with icon and label with border ring">
                <span class="win-commandicon win-commandring icon-play"></span>
                <!-- <span class="win-label">Start</span> -->
             </button>
             <script>
              $("#startBtn").click(function(){
                //alert("the thing");
                logerCall();
                //initializeLogger();
              })
             </script>
            </li>
            <li>
              <button class="win-command red" id = "stopBtn" rel="tootlip" title="Command with icon and label with border ring">
                <span class="win-commandicon win-commandring icon-stop"></span>
                <!-- <span class="win-label">Stop</span> -->
             </button>
             <script>
              $("#stopBtn").click(function(){
                //alert("the thing");
                loggerStop();
                //initializeLogger();
              })
             </script>
            </li>
          </ul>

          <ul class="nav navbar-nav configure-log-controls">
            <li>
              <button class="win-command" href="#" id="newConfig" rel="tootlip" title="Create a new configuration">
                <span class="win-commandicon win-commandring icon-file-4"></span>
                <!-- <span class="win-label">New</span> -->
             </button>
             <script>
              $(document).ready( function() {
               $("#newConfig").on("click", function() {
                 $("#configFormDisplay").load("../../ljswitchboard-module_manager/lib/switchboard_modules/simple_logger/templates/create_configuration.html");
                 });
             });

             $("#newConfig").click(function() {
              //window.confirm("Would you like to clear all of the fields? This will delete all form data!");
              if (confirm("Would you like to clear all of the fields? This will delete all form data!")) {
                  // document.getElementById("logName").value = "";
                  // document.getElementById("devSN").value = "";
                  // document.getElementById("dataGroupName").value = "";
                  //seperation of the top half and the lower half

                  //clears all of the text boxes that are in the form and then re does the deviceSN
                  //
                  $('#configForm input[type="text"]').val('');
                  document.getElementById("devSN").value = "{{ deviceSN }}"

                  $(".register-input").each(function(){
                    var input = $(this)
                    input.removeClass("valid")
                    input.removeClass("invalid")
                  });

                  // document.getElementById("validationCustom").value = "";
                  // document.getElementById("validationCustom02").value = "";
                  // document.getElementById("validationCustom03").value = "";
                  // document.getElementById("validationCustom04").value = "";
                  // document.getElementById("validationCustom05").value = "";
                  // document.getElementById("validationCustom06").value = "";
                  // document.getElementById("validationCustom07").value = "";
                  // document.getElementById("validationCustom08").value = "";
                } 
                //else {
                //   // nothing should happen
                // }
             });
            </script>
            </li>
            <li>
              <button class="win-command" rel="tootlip" title="Load a configuration" onClick="openFile(loadConfigFile)">
                <span class="win-commandicon win-commandring icon-folder-open openfile"></span>
                <!-- <span class="win-label">Open</span> -->
             </button>
             <script>
              $(".openfile").click(function(){
                sendXHR("GET", "../../D:/experiement/formData.txt", null, function(response) { // response contains the content of the description.txt file.
                document.getElementById("configForm").innerHTML = response; // Use innerHTML to get or set the html content.
              });
              })
             </script>
            </li>
            <li>
              <button class="win-command " rel="tootlip" title="Save configuration" >
                <span class="win-commandicon win-commandring icon-disk saveConfig" ></span>
                <!-- <span class="win-label">Save</span> -->
             </button>
             <script>
              //srarting to tru to get a .txt file to be downloaded to the computer to be able to
              // later be able to grab it a put it back into the file.
              $(".saveConfig").click(function(){
                  //I know this works to save the data as a .txt file
                  // Get the data from each element on the form.
              //     const logName = document.getElementById('logName');
              //     const dataGroupName = document.getElementById('dataGroupName');
              //     const register1 = document.getElementById('validationCustom01');
              //     const register2 = document.getElementById('validationCustom02');
              //     const register3 = document.getElementById('validationCustom03');
              //     const register4 = document.getElementById('validationCustom04');
              //     const register5 = document.getElementById('validationCustom05');
              //     const register6 = document.getElementById('validationCustom06');
              //     const register7 = document.getElementById('validationCustom07');
              //     const register8 = document.getElementById('validationCustom08');
              //     const runTime = document.getElementById('runtimeSec');

                  
              //     // This variable stores all the data.
              //     let data = 
              //         '\r Log Name: ' +logName.value + ' \r\n ' +
              //         'Data Group Name' +dataGroupName.value + ' \r\n ' +
              //         'Register 1: ' + register1.value + ' \r\n ' +
              //         'Register 2: ' +register2.value + ' \r\n ' + 
              //         'Register 3: ' +register3.value + ' \r\n ' + 
              //         'Register 4: ' +register4.value + ' \r\n ' + 
              //         'Register 5: ' +register5.value + ' \r\n ' + 
              //         'Register 6: ' +register6.value + ' \r\n ' + 
              //         'Register 7: ' +register7.value + ' \r\n ' + 
              //         'Register 8: ' +register8.value + ' \r\n ' +
              //         'Run Time in Seconds: ' +runTime.value + ' \r\n ';
                  
              //     // Convert the text to BLOB.
              //     const textToBLOB = new Blob([data], { type: 'text/plain' });
              //     const sFileName = 'formData.jason';      // The file to save the data.

              //     let newLink = document.createElement("a");
              //     newLink.download = sFileName;

              //     if (window.webkitURL != null) {
              //         newLink.href = window.webkitURL.createObjectURL(textToBLOB);
              //     }
              //     else {
              //         newLink.href = window.URL.createObjectURL(textToBLOB);
              //         newLink.style.display = "none";
              //         document.body.appendChild(newLink);
              //     }

              //     newLink.click(); 
               })

             </script>
             
            </li>
            <!-- <li>
              <button class="win-command" rel="tootlip" id="resetBtn" title="Command with icon and label with border ring">
                <span class="win-commandicon win-commandring icon-code-3"></span>
                <span class="win-label">clear</span> 
             </button>
             <script>
              $("#resetBtn").click(function(){
                
              })
             </script>
            </li> -->
          </ul>
          <ul class="nav pull-right active-log-controls">
            <li>
              <button class="win-command" href="#" id="configViewButton" rel="tootlip" title="Configure">
                <span class="win-commandicon win-commandring icon-cog-4"></span>
                <!-- <span class="win-label">Configure</span> -->
             </button>
             <script>
              $("#configViewButton").click(function(){
                $('.datviewContainer').hide();
                $('#formContainer').show();
                document.getElementById("display-array").textContent = "";
              });
             </script>
             <!-- <script>
               $(document).ready( function() {
                $("#configViewButton").on("click", function() {
                  $("#config_view").load("../../ljswitchboard-module_manager/lib/switchboard_modules/simple_logger/templates/view_current_configuration.html");
                  });
              });
             </script> -->
            </li>
          </ul>
          <ul class="nav pull-right configure-log-controls">
            <li>
              <button class="win-command" rel="tootlip" title="Command with icon and label with border ring">
                <span class="win-commandicon win-commandring  icon-statistics" id="DataView"></span>
                <!-- <span class="win-label">Dashboard</span> -->
             </button>
             <!-- working here so i don't forget where i am -->
             <script>
              $("#DataView").click(function(){
                $('#formContainer').hide();
                $('#dataView').show();
                document.getElementById("display-array").textContent = "";
                
                
                // array to be displayed
                // window.array = new Array();
                window.array = [];
                $('.register-input').each(function(){
                  array.push($(this).val());
                })

                //displays the array seperated by a new line so latter down the
                //line we can put the corisponding data next to it
                //console.log(str.split(',').join("\r\n"));
                //assigns the array elementto the div class
                //Inserts the values in the form to the logger view
                
                $.each(array, function(index, val){
                  $('div.logerViewStyle').append(this + '\n' + '<div class="data">data</div>')
                })

                // $('.info').each(function(){
                //   $('div.info').change()
                // })
                
              });
             </script>
            </li>
          </ul>
        </div><!-- /.container -->
      </div>
    </div>
  </div><!-- /#logger_controls -->
  <!-- <div id="config_view" class="config-pannel">
    <pre id="currentConfigDisp" style="visibility: hidden;"></pre> -->
    <!-- <div id="config_forum"> -->
      <!-- <div class="panel-group"> -->
            <!-- <div class="panel panel-default">
              <div class="panel-heading" role="button" id="configured-views">
                <h4 class="panel-title"> -->
                  <!-- <a class="collapsed" role="button" data-toggle="collapse" href="#loggerViewsCollapsible" aria-expanded="false" aria-controls="collapseOne">
                    Configured Views
                    <span class="badge">0</span>
                  </a> -->
                <!-- </h4>
              </div> -->
              <!-- <div id="loggerViewsCollapsible" class="panel-collapse collapse" role="tabpanel" aria-labelledby="configured-views">
                <div class="panel-body">
                  <div>
                    <p>This is where the configured views will be displayed</p>
                  </div>
                </div>
              </div> -->
            <!-- </div> -->
            <!-- <div class="panel panel-default">
              <div class="panel-heading" role="button" id="configured-data-groups">
                <h4 class="panel-title">
                  <a class="collapsed" role="button" data-toggle="collapse" href="#loggerDataGroupsCollapsible" aria-expanded="false" aria-controls="collapseThree">
                    Defined Data Groups
                    <span class="badge">0</span>
                  </a>
                </h4>
              </div>
              <div id="loggerDataGroupsCollapsible" class="panel-collapse collapse" role="tabpanel" aria-labelledby="configured-data-groups">
                <div class="panel-body">
                  <div>
                    <p>This is where the configured data groups will be displayed.</p>
                  </div>
                </div>
              </div>
            </div> -->
            <!-- </tr>
          </table>
      </div>
    </div> -->
  <!-- </div> -->
  <!-- <div id="logger_view" class="logger-pannel">
    <p>This is the active logger view</p>
  </div>
</div> -->

<div class="container" id="formContainer">
<div class="container">
  <div class="col-sm-7">
      <form id = "configForm" class="needs-validation" >
          <div class="form-group">
              <label for="logName">
                  Log name:
              </label>
              <input type="text" name="logName" id="logName" required class="form-control" class="form-control">
              <!-- <h5 id="nameCheck" style="color: red;">
                  Log Name is Missing
              </h5> -->
          </div>

          <div class="form-group">
            <label for="devSN">
                Device Serial Number:
            </label>
            <input type="text" name="devSN" id="devSN" value = "{{ deviceSN }}" required class="form-control" class="form-control" disabled>
            <!-- <h5 id="nameCheck" style="color: red;">
                Device Serial Number is Missing
            </h5> -->
            
        </div>
          <div class="form-group">
              <label for="dataGroupName">
                  Data Group Name:
              </label>
              <input type="text" name="dataGroup" id="dataGroupName" required class="form-control">
              <!-- <h5 id="groupCheck" class="form-text text-muted invalid-feedback" style="color: red;">
                  Please name the data group.
              </h5> -->
          </div>

          <div class="form-group">
            <label for="validationCustom05">
              Register Name(s):
          </label>
          <!-- start of the registers -->
          <div class="row">
            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #1
              </small>
              <input type="text" class="form-control register-input" id="validationCustom01" name="array[]" 
              oninput="this.value = this.value.toUpperCase()">
              <span class="clear-input">x</span>
            </div>
            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #2
              </small>
              <input type="text" class="form-control register-input" id="validationCustom02" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #3
              </small>
              <input type="text" class="form-control register-input" id="validationCustom03" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #4
              </small>
              <input type="text" class="form-control register-input" id="validationCustom04" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #5
              </small>
              <input type="text" class="form-control register-input" id="validationCustom05" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #6
              </small>
              <input type="text" class="form-control register-input" id="validationCustom06" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #7
              </small>
              <input type="text" class="form-control register-input" id="validationCustom07" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>

            <div class="col-sm-6">
              <small id="regCheck" class="form-text
                text-muted invalid-feedback">
                Register #8
              </small>
              <input type="text" class="form-control register-input" id="validationCustom08" name="array[]"
              oninput="this.value = this.value.toUpperCase()">
              <span class = "clear-input">x</span>
            </div>
              <!-- end of the refgisters -->

            <div class="col-sm-6">
              <small >
              Run Time in Seconds
              </small>
              <!-- <div </div> -->
              <input type="number" class="form-control" id="runtimeSec"
              oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" />
              <span class="clear-input">x</span>
            </div>
            
          
          </div>
        </div>
          <div class="form-group">
            <label for="filePath">
              Log File(s) Save Location:
          </label>
            <div class="col-lg">
              <!-- <input type="file" class="form-control" id="selectDir" required class="form-control" webkitdirectory directory>
              <small id="pathCheck" class="form-text
                  text-muted invalid-feedback">
                  Please Provide a Valid Directory Path.
              </small> -->
              <!-- <div style="text-align:center;"> -->
                <input type="text"  id="actual-file" class="form-control" required disabled="disabled"/>
                <input type="button" value="Choose a file" id="select-file" class="btnUpdate"/>
              <!-- </div> -->
            </div>
          </div>
          <!-- btn btn-primary -->

          <!-- <button id="submitbtn" title="Verify and Load Configuration" class="btnUpdate" > -->
          <input type="submit" value="Verify and Load Configuration" class="btnUpdate">
          <!-- <script src="/controller.js"></script> -->

          <!-- onClick="isValidRegister('this.value')" -->

      </form>

      <script>
        /**
         * All Form Validation Functionality
         * */
        $(document).ready(function () {
          $('.datviewContainer').hide();
          $('#formContainer').show();
          const { dialog } = require('electron').remote; 
          var fs = require('fs');

          document.getElementById('select-file').addEventListener('click',function(){
                dialog.showOpenDialog({
                  properties: ['openDirectory']
                }).then((data) => {
                  $("#actual-file").val(data.filePaths)
                })
            },false);

          // Real Time Register Name Validation, 
          // triggered everytime the input box loses focus (onChange listener with jQuery)
          $(".register-input").change(function(){
            var input = $(this)
            if(!isValidRegister(input.val())) {
              input.addClass("invalid").removeClass("valid")
            }
            else if (input.val()=='') { input.removeClass("invalid"); }
            else {
              input.addClass("valid").removeClass("invalid")
            }
          });


          // listener for clearing of text box
          // clears box, removes valid/invalid border box
          // and refocuses cursor 
          $(".clear-input").click(function(){
            var input = $(this).prev(); 
            input.val('')
            input.removeClass("invalid").removeClass("valid")
            input.focus();
          });


          document.getElementById("configForm").addEventListener('submit', function() {
            event.preventDefault(); 
            var valid = validateForm();
            if(valid){
              $("#configForm :input").prop("disabled", true)
              showInfoMessage("Configuration Valid")
            }
            return false;
          });

          function validateForm() {
            // To-Do: Do stuff here to check to make sure every form input is valid
            // Mark things if they arent valid and need user attention
            // Then disable everything and logger will be ready to start
            return true
          }

          // Do we even need this anymore with real time validation?????
          // function validateForm() {
          //   var regArr = [];
          //   // uses jquery to loop through all register form entries
          //   $(".register-input").each(function(i, obj) {
          //     let regVal = $(this).val()
          //       // If input box is not empty, validate register
          //       if(regVal.length > 0) { 
          //         if(isValidRegister(regVal)) {
          //           regArr.push(regVal);
          //           // $(this).get(0).setCustomValidity('something cool')
          //         }
          //         else {
          //         // This line will give the small popup that a register is invalid
          //         $(this).get(0).setCustomValidity('Invalid Register')
          //         }
          //       }
          //   });
          // }
          }
        );

        let qText = "Would you like to apply the previously selected registers";
        if(confirm(qText) == true){
            saveArraysInScope();
            $('.register-input').each(function(){
              let val = $.trim($(this).val());
              console.error("val:", val, val.length)
              if(val.length > 0){
                $(".register-input").trigger("change");
              }
            })
          }
          //$('#configForm input[type="text"]').val('');
          // $.each(array, function(index, item){
          //   $('input.validationCustom input[type="text"]').replaceWith("something cool");
          // });


          //document.getElementById("display-array").textContent = "AIN2";
          document.getElementById('validationCustom01').value = array[0];
          document.getElementById('validationCustom02').value = array[1];
          document.getElementById('validationCustom03').value = array[2];
          document.getElementById('validationCustom04').value = array[3];
          document.getElementById('validationCustom05').value = array[4];
          document.getElementById('validationCustom06').value = array[5];
          document.getElementById('validationCustom07').value = array[6];
          document.getElementById('validationCustom08').value = array[7];
          
        //}
        
      </script>
  </div>
</div>
</div>

<div class="datviewContainer" id="dataView" >
  <script>
    var arrayElements = document.getElementById("array");
    var finalArray = jQuery.makeArray( arrayElements );
    var res = finalArray.length;
    for (var i = 0; i < 3; i++){
      var $label = $("<label>").text('Date:');
      // table.append(row);
    }

    finalArray.reverse();
    $( finalArray ).appendTo( document.body );
  </script>
  <div id="display-array" class="logerViewStyle"></div>
  <!-- <div id="dataview"> where the data tables will go</div>
  <div id="display-array1" class="logerViewStyle"></div>
  <div id="display-array2" class="logerViewStyle"></div>
  <div id="display-array3" class="logerViewStyle"></div>
  <div id="display-array4" class="logerViewStyle"></div>
  <div id="display-array5" class="logerViewStyle"></div>
  <div id="display-array6" class="logerViewStyle"></div>
  <div id="display-array7" class="logerViewStyle"></div> -->
</div>


<script>
  function sendXHR(type, url, data, callback) {
    //alert("it is getting the function")
    var newXHR = new XMLHttpRequest() || new window.ActiveXObject("Microsoft.XMLHTTP");
    newXHR.open(type, url, true);
    newXHR.send(data);
    newXHR.onreadystatechange = function() {
      if (this.status === 200 && this.readyState === 4) {
        callback(this.response);
        alert("This is not good")
      }
    };
  }
</script>

<pre class="selectableText">{{printContext}}</pre>
<!-- <pre class="selectableText">{{startupRegisters}}</pre> -->

<!-- <div id="list pf reg"></div> -->
{{/with}}